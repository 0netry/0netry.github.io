{"title":"PE文件格式","uid":"cb93d0cd82726110c8a724aa5589f118","slug":"PE文件格式","date":"2021-12-21T12:42:30.000Z","updated":"2025-06-08T15:10:20.465Z","comments":true,"path":"api/articles/PE文件格式.json","keywords":null,"cover":[],"content":"<h1 id=\"PE文件种类\"><a href=\"#PE文件种类\" class=\"headerlink\" title=\"PE文件种类\"></a>PE文件种类</h1><table>\n<thead>\n<tr>\n<th>种类</th>\n<th>主扩展名</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>可执行系列</td>\n<td>EXE、SRC</td>\n</tr>\n<tr>\n<td>库系列</td>\n<td>DLL、OCX、CPL、DRV</td>\n</tr>\n<tr>\n<td>驱动程序系列</td>\n<td>SYS、VXD</td>\n</tr>\n<tr>\n<td>对象文件系列</td>\n<td>OBJ</td>\n</tr>\n</tbody></table>\n<p>严格来说，OBJ文件之外的所有文件都是可执行的。DLL、SYS文件等虽然不能直接在shell（Explorer.exe）中运行，但可以使用其他方法（调试器、服务等）执行。</p>\n<h1 id=\"基本结构\"><a href=\"#基本结构\" class=\"headerlink\" title=\"基本结构\"></a>基本结构</h1><p>从DOS头（DOS Header）到节区头（Section Header）是PE头部分，其下的节区合成PE体。</p>\n<p>文件中使用偏移（offset），内存中使用VA（Virtual Address，虚拟地址）来表示位置。</p>\n<h1 id=\"VA-amp-RVA\"><a href=\"#VA-amp-RVA\" class=\"headerlink\" title=\"VA&amp;RVA\"></a>VA&amp;RVA</h1><p>VA指的是进程虚拟内存的绝对地址，RVA（Relative Virtual Address，相对虚拟地址）指从某个基准位置（I    mageBase）开始的相对地址。VA与RVA满足下面的换算关系：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">RVA+ImageBase=VA</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"PE头\"><a href=\"#PE头\" class=\"headerlink\" title=\"PE头\"></a>PE头</h1><h2 id=\"DOS头（IMAGE-DOS-HEADER）\"><a href=\"#DOS头（IMAGE-DOS-HEADER）\" class=\"headerlink\" title=\"DOS头（IMAGE_DOS_HEADER）\"></a>DOS头（IMAGE_DOS_HEADER）</h2><h3 id=\"IMAGE-DOS-HEADER结构体\"><a href=\"#IMAGE-DOS-HEADER结构体\" class=\"headerlink\" title=\"IMAGE_DOS_HEADER结构体\"></a>IMAGE_DOS_HEADER结构体</h3><p>IMAGE_DOS_HEADER结构体的大小为64字节。其定义如下：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> _<span class=\"title\">IMAGE_DOS_HEADER</span> &#123;</span>      <span class=\"comment\">// DOS .EXE header</span></span><br><span class=\"line\">    WORD   e_magic;                     <span class=\"comment\">// Magic number</span></span><br><span class=\"line\">    WORD   e_cblp;                      <span class=\"comment\">// Bytes on last page of file</span></span><br><span class=\"line\">    WORD   e_cp;                        <span class=\"comment\">// Pages in file</span></span><br><span class=\"line\">    WORD   e_crlc;                      <span class=\"comment\">// Relocations</span></span><br><span class=\"line\">    WORD   e_cparhdr;                   <span class=\"comment\">// Size of header in paragraphs</span></span><br><span class=\"line\">    WORD   e_minalloc;                  <span class=\"comment\">// Minimum extra paragraphs needed</span></span><br><span class=\"line\">    WORD   e_maxalloc;                  <span class=\"comment\">// Maximum extra paragraphs needed</span></span><br><span class=\"line\">    WORD   e_ss;                        <span class=\"comment\">// Initial (relative) SS value</span></span><br><span class=\"line\">    WORD   e_sp;                        <span class=\"comment\">// Initial SP value</span></span><br><span class=\"line\">    WORD   e_csum;                      <span class=\"comment\">// Checksum</span></span><br><span class=\"line\">    WORD   e_ip;                        <span class=\"comment\">// Initial IP value</span></span><br><span class=\"line\">    WORD   e_cs;                        <span class=\"comment\">// Initial (relative) CS value</span></span><br><span class=\"line\">    WORD   e_lfarlc;                    <span class=\"comment\">// File address of relocation table</span></span><br><span class=\"line\">    WORD   e_ovno;                      <span class=\"comment\">// Overlay number</span></span><br><span class=\"line\">    WORD   e_res[<span class=\"number\">4</span>];                    <span class=\"comment\">// Reserved words</span></span><br><span class=\"line\">    WORD   e_oemid;                     <span class=\"comment\">// OEM identifier (for e_oeminfo)</span></span><br><span class=\"line\">    WORD   e_oeminfo;                   <span class=\"comment\">// OEM information; e_oemid specific</span></span><br><span class=\"line\">    WORD   e_res2[<span class=\"number\">10</span>];                  <span class=\"comment\">// Reserved words</span></span><br><span class=\"line\">    LONG   e_lfanew;                    <span class=\"comment\">// File address of new exe header</span></span><br><span class=\"line\">  &#125; IMAGE_DOS_HEADER, *PIMAGE_DOS_HEADER;</span><br><span class=\"line\">                                                                        <span class=\"comment\">//winnt.h</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/GitHub%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/OS_HEADER.png\" alt=\"IMAGE_DOS_HEADER\"></p>\n<h3 id=\"重要成员\"><a href=\"#重要成员\" class=\"headerlink\" title=\"重要成员\"></a>重要成员</h3><h4 id=\"e-magic（0x00）\"><a href=\"#e-magic（0x00）\" class=\"headerlink\" title=\"e_magic（0x00）\"></a>e_magic（0x00）</h4><p>DOS签名（4D5A&#x3D;&gt;ASCII值”MZ”）</p>\n<h4 id=\"e-lfanew（0x3c）\"><a href=\"#e-lfanew（0x3c）\" class=\"headerlink\" title=\"e_lfanew（0x3c）\"></a>e_lfanew（0x3c）</h4><p>指示NT头（IMAGE_NT_HEADERS）的偏移</p>\n<h2 id=\"DOS存根（IMAGE-DOS-STUB）\"><a href=\"#DOS存根（IMAGE-DOS-STUB）\" class=\"headerlink\" title=\"DOS存根（IMAGE_DOS_STUB）\"></a>DOS存根（IMAGE_DOS_STUB）</h2><p>IMAGE_DOS_STUB</p>\n<h2 id=\"NT头（IMAGE-NT-HEADERS）（0x3c）\"><a href=\"#NT头（IMAGE-NT-HEADERS）（0x3c）\" class=\"headerlink\" title=\"NT头（IMAGE_NT_HEADERS）（0x3c）\"></a>NT头（IMAGE_NT_HEADERS）（0x3c）</h2><h3 id=\"32位\"><a href=\"#32位\" class=\"headerlink\" title=\"32位\"></a>32位</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> _<span class=\"title\">IMAGE_NT_HEADERS</span> &#123;</span></span><br><span class=\"line\">    DWORD Signature;                           <span class=\"comment\">//PE Signature：50450000（&quot;PE&quot;00）</span></span><br><span class=\"line\">    IMAGE_FILE_HEADER FileHeader;              <span class=\"comment\">//文件头</span></span><br><span class=\"line\">    IMAGE_OPTIONAL_HEADER32 OptionalHeader;    <span class=\"comment\">//可选头</span></span><br><span class=\"line\">&#125; IMAGE_NT_HEADERS32, *PIMAGE_NT_HEADERS32;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/GitHub%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/T_HEADERS.png\" alt=\"IMAGE_NT_HEADERS\"></p>\n<h3 id=\"64位\"><a href=\"#64位\" class=\"headerlink\" title=\"64位\"></a>64位</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> _<span class=\"title\">IMAGE_NT_HEADERS64</span> &#123;</span></span><br><span class=\"line\">    DWORD Signature;                         <span class=\"comment\">//PE Signature：50450000（&quot;PE&quot;00）</span></span><br><span class=\"line\">    IMAGE_FILE_HEADER FileHeader;            <span class=\"comment\">//文件头</span></span><br><span class=\"line\">    IMAGE_OPTIONAL_HEADER64 OptionalHeader;  <span class=\"comment\">//可选头</span></span><br><span class=\"line\">&#125; IMAGE_NT_HEADERS64, *PIMAGE_NT_HEADERS64;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"NT头：文件头（0x04）\"><a href=\"#NT头：文件头（0x04）\" class=\"headerlink\" title=\"NT头：文件头（0x04）\"></a>NT头：文件头（0x04）</h3><h4 id=\"IMAGE-FILE-HEADER结构体\"><a href=\"#IMAGE-FILE-HEADER结构体\" class=\"headerlink\" title=\"IMAGE_FILE_HEADER结构体\"></a>IMAGE_FILE_HEADER结构体</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> _<span class=\"title\">IMAGE_FILE_HEADER</span> &#123;</span></span><br><span class=\"line\">    WORD    Machine;</span><br><span class=\"line\">    WORD    NumberOfSections;</span><br><span class=\"line\">    DWORD   TimeDateStamp;</span><br><span class=\"line\">    DWORD   PointerToSymbolTable;</span><br><span class=\"line\">    DWORD   NumberOfSymbols;</span><br><span class=\"line\">    WORD    SizeOfOptionalHeader;</span><br><span class=\"line\">    WORD    Characteristics;</span><br><span class=\"line\">&#125; IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/GitHub%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/ILE_HEADER.png\" alt=\"IMAGE_FILE_HEADER\"></p>\n<h4 id=\"重要成员-1\"><a href=\"#重要成员-1\" class=\"headerlink\" title=\"重要成员\"></a>重要成员</h4><h5 id=\"Machine（0x00）\"><a href=\"#Machine（0x00）\" class=\"headerlink\" title=\"Machine（0x00）\"></a>Machine（0x00）</h5><p>每个CPU都拥有唯一的Machine码，兼容32位Intel x86芯片的Machine码为14C。其他定义如下：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_UNKNOWN           0</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_TARGET_HOST       0x0001  <span class=\"comment\">// Useful for indicating we want to                                                         interact with the host and not a                                                         WoW guest.</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_I386              0x014c  <span class=\"comment\">// Intel 386.</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_R3000             0x0162  <span class=\"comment\">// MIPS little-endian, 0x160 big-                                                           endian</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_R4000             0x0166  <span class=\"comment\">// MIPS little-endian</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_R10000            0x0168  <span class=\"comment\">// MIPS little-endian</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_WCEMIPSV2         0x0169  <span class=\"comment\">// MIPS little-endian WCE v2</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_ALPHA             0x0184  <span class=\"comment\">// Alpha_AXP</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_SH3               0x01a2  <span class=\"comment\">// SH3 little-endian</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_SH3DSP            0x01a3</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_SH3E              0x01a4  <span class=\"comment\">// SH3E little-endian</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_SH4               0x01a6  <span class=\"comment\">// SH4 little-endian</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_SH5               0x01a8  <span class=\"comment\">// SH5</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_ARM               0x01c0  <span class=\"comment\">// ARM Little-Endian</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_THUMB             0x01c2  <span class=\"comment\">// ARM Thumb/Thumb-2 Little-Endian</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_ARMNT             0x01c4  <span class=\"comment\">// ARM Thumb-2 Little-Endian</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_AM33              0x01d3</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_POWERPC           0x01F0  <span class=\"comment\">// IBM PowerPC Little-Endian</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_POWERPCFP         0x01f1</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_IA64              0x0200  <span class=\"comment\">// Intel 64</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_MIPS16            0x0266  <span class=\"comment\">// MIPS</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_ALPHA64           0x0284  <span class=\"comment\">// ALPHA64</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_MIPSFPU           0x0366  <span class=\"comment\">// MIPS</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_MIPSFPU16         0x0466  <span class=\"comment\">// MIPS</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_AXP64             IMAGE_FILE_MACHINE_ALPHA64</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_TRICORE           0x0520  <span class=\"comment\">// Infineon</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_CEF               0x0CEF</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_EBC               0x0EBC  <span class=\"comment\">// EFI Byte Code</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_AMD64             0x8664  <span class=\"comment\">// AMD64 (K8)</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_M32R              0x9041  <span class=\"comment\">// M32R little-endian</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_ARM64             0xAA64  <span class=\"comment\">// ARM64 Little-Endian</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_MACHINE_CEE               0xC0EE</span></span><br></pre></td></tr></table></figure>\n\n<h5 id=\"NumberOfSections\"><a href=\"#NumberOfSections\" class=\"headerlink\" title=\"NumberOfSections\"></a>NumberOfSections</h5><p>NumberOfSections用来指出文件中存在的节区数量。该值一定要大于0，且当定义的节区数量与实际节区不同时，将发生运行错误。</p>\n<h5 id=\"SizeOfOptionalHeader\"><a href=\"#SizeOfOptionalHeader\" class=\"headerlink\" title=\"SizeOfOptionalHeader\"></a>SizeOfOptionalHeader</h5><p>SizeOfOptionalHeader用来指出IMAGE_NT_HEADERS-IMAGE_OPTIONAL_HEADER32结构体的长度。</p>\n<p>PE32+格式的文件使用的是IMAGE_OPTIONAL_HEADER64结构体。</p>\n<h5 id=\"Characteristics\"><a href=\"#Characteristics\" class=\"headerlink\" title=\"Characteristics\"></a>Characteristics</h5><p>该字段用于标识文件的属性，文件是否是可运行的形态、是否为DLL文件等信息，以bit OR形式组合起来（常见0002h和2000h）。</p>\n<p>定义如下：</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_RELOCS_STRIPPED           0x0001  <span class=\"comment\">// Relocation info stripped from                                                             file.</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_EXECUTABLE_IMAGE          0x0002  <span class=\"comment\">// File is executable  (i.e. no                                                             unresolved external references).</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_LINE_NUMS_STRIPPED        0x0004  <span class=\"comment\">// Line nunbers stripped from file.</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_LOCAL_SYMS_STRIPPED       0x0008  <span class=\"comment\">// Local symbols stripped from file.</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_AGGRESIVE_WS_TRIM         0x0010  <span class=\"comment\">// Aggressively trim working set</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_LARGE_ADDRESS_AWARE       0x0020  <span class=\"comment\">// App can handle &gt;2gb addresses</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_BYTES_REVERSED_LO         0x0080  <span class=\"comment\">// Bytes of machine word are                                                                 reversed.</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_32BIT_MACHINE             0x0100  <span class=\"comment\">// 32 bit word machine.</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_DEBUG_STRIPPED            0x0200  <span class=\"comment\">// Debugging info stripped from file                                                         in .DBG file</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_REMOVABLE_RUN_FROM_SWAP   0x0400  <span class=\"comment\">// If Image is on removable media,                                                           copy and run from the swap file.</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_NET_RUN_FROM_SWAP         0x0800  <span class=\"comment\">// If Image is on Net, copy and run                                                         from the swap file.</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_SYSTEM                    0x1000  <span class=\"comment\">// System File.</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_DLL                       0x2000  <span class=\"comment\">// File is a DLL.</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_UP_SYSTEM_ONLY            0x4000  <span class=\"comment\">// File should only be run on a UP                                                           machine</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_FILE_BYTES_REVERSED_HI         0x8000  <span class=\"comment\">// Bytes of machine word are                                                                 reversed.</span></span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"NT头：可选头（0x18）\"><a href=\"#NT头：可选头（0x18）\" class=\"headerlink\" title=\"NT头：可选头（0x18）\"></a>NT头：可选头（0x18）</h3><h4 id=\"IMAGE-OPTIONAL-HEADER32结构体\"><a href=\"#IMAGE-OPTIONAL-HEADER32结构体\" class=\"headerlink\" title=\"IMAGE_OPTIONAL_HEADER32结构体\"></a>IMAGE_OPTIONAL_HEADER32结构体</h4><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> _<span class=\"title\">IMAGE_DATA_DIRECTORY</span> &#123;</span></span><br><span class=\"line\">    DWORD   VirtualAddress;</span><br><span class=\"line\">    DWORD   Size;</span><br><span class=\"line\">&#125; IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"keyword\">define</span> IMAGE_NUMBEROF_DIRECTORY_ENTRIES    16</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"comment\">// Optional header format.</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> _<span class=\"title\">IMAGE_OPTIONAL_HEADER</span> &#123;</span></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"comment\">// Standard fields.</span></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\">    WORD    Magic;</span><br><span class=\"line\">    BYTE    MajorLinkerVersion;</span><br><span class=\"line\">    BYTE    MinorLinkerVersion;</span><br><span class=\"line\">    DWORD   SizeOfCode;</span><br><span class=\"line\">    DWORD   SizeOfInitializedData;</span><br><span class=\"line\">    DWORD   SizeOfUninitializedData;</span><br><span class=\"line\">    DWORD   AddressOfEntryPoint;</span><br><span class=\"line\">    DWORD   BaseOfCode;</span><br><span class=\"line\">    DWORD   BaseOfData;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"comment\">// NT additional fields.</span></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\"></span><br><span class=\"line\">    DWORD   ImageBase;</span><br><span class=\"line\">    DWORD   SectionAlignment;</span><br><span class=\"line\">    DWORD   FileAlignment;</span><br><span class=\"line\">    WORD    MajorOperatingSystemVersion;</span><br><span class=\"line\">    WORD    MinorOperatingSystemVersion;</span><br><span class=\"line\">    WORD    MajorImageVersion;</span><br><span class=\"line\">    WORD    MinorImageVersion;</span><br><span class=\"line\">    WORD    MajorSubsystemVersion;</span><br><span class=\"line\">    WORD    MinorSubsystemVersion;</span><br><span class=\"line\">    DWORD   Win32VersionValue;</span><br><span class=\"line\">    DWORD   SizeOfImage;</span><br><span class=\"line\">    DWORD   SizeOfHeaders;</span><br><span class=\"line\">    DWORD   CheckSum;</span><br><span class=\"line\">    WORD    Subsystem;</span><br><span class=\"line\">    WORD    DllCharacteristics;</span><br><span class=\"line\">    DWORD   SizeOfStackReserve;</span><br><span class=\"line\">    DWORD   SizeOfStackCommit;</span><br><span class=\"line\">    DWORD   SizeOfHeapReserve;</span><br><span class=\"line\">    DWORD   SizeOfHeapCommit;</span><br><span class=\"line\">    DWORD   LoaderFlags;</span><br><span class=\"line\">    DWORD   NumberOfRvaAndSizes;</span><br><span class=\"line\">    IMAGE_DATA_DIRECTORY DataDirectory[IMAGE_NUMBEROF_DIRECTORY_ENTRIES];</span><br><span class=\"line\">&#125; IMAGE_OPTIONAL_HEADER32, *PIMAGE_OPTIONAL_HEADER32;</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/post/GitHub%E6%90%AD%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E5%8D%9A%E5%AE%A2/PTIONAL_HEADER32.png\" alt=\"IMAGE_OPTIONAL_HEADER32\"></p>\n<h4 id=\"重要成员-2\"><a href=\"#重要成员-2\" class=\"headerlink\" title=\"重要成员\"></a>重要成员</h4><h5 id=\"Magic\"><a href=\"#Magic\" class=\"headerlink\" title=\"Magic\"></a>Magic</h5><p>为IMAGE_OPTIONAL_HEADER32结构体时，Magic码为10B；为IMAGE_OPTIONAL_HEADER64结构体时，Magic码为20B</p>\n<h5 id=\"ImageBase\"><a href=\"#ImageBase\" class=\"headerlink\" title=\"ImageBase\"></a>ImageBase</h5><h5 id=\"SectionAlignment、FileAlignment\"><a href=\"#SectionAlignment、FileAlignment\" class=\"headerlink\" title=\"SectionAlignment、FileAlignment\"></a>SectionAlignment、FileAlignment</h5><h5 id=\"SizeOfImage\"><a href=\"#SizeOfImage\" class=\"headerlink\" title=\"SizeOfImage\"></a>SizeOfImage</h5><h5 id=\"SizeOfHeaders\"><a href=\"#SizeOfHeaders\" class=\"headerlink\" title=\"SizeOfHeaders\"></a>SizeOfHeaders</h5><h5 id=\"Subsystem\"><a href=\"#Subsystem\" class=\"headerlink\" title=\"Subsystem\"></a>Subsystem</h5><h5 id=\"DllCharacteristics\"><a href=\"#DllCharacteristics\" class=\"headerlink\" title=\"DllCharacteristics\"></a>DllCharacteristics</h5><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// DllCharacteristics Entries</span><br><span class=\"line\"></span><br><span class=\"line\">//      IMAGE_LIBRARY_PROCESS_INIT            0x0001     // Reserved.</span><br><span class=\"line\">//      IMAGE_LIBRARY_PROCESS_TERM            0x0002     // Reserved.</span><br><span class=\"line\">//      IMAGE_LIBRARY_THREAD_INIT             0x0004     // Reserved.</span><br><span class=\"line\">//      IMAGE_LIBRARY_THREAD_TERM             0x0008     // Reserved.</span><br><span class=\"line\">#define IMAGE_DLLCHARACTERISTICS_HIGH_ENTROPY_VA    0x0020  // Image can handle a high entropy 64-bit virtual address space.</span><br><span class=\"line\">#define IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE 0x0040     // DLL can move.</span><br><span class=\"line\">#define IMAGE_DLLCHARACTERISTICS_FORCE_INTEGRITY    0x0080     // Code Integrity Image</span><br><span class=\"line\">#define IMAGE_DLLCHARACTERISTICS_NX_COMPAT    0x0100     // Image is NX compatible</span><br><span class=\"line\">#define IMAGE_DLLCHARACTERISTICS_NO_ISOLATION 0x0200     // Image understands isolation and doesn&#x27;t want it</span><br><span class=\"line\">#define IMAGE_DLLCHARACTERISTICS_NO_SEH       0x0400     // Image does not use SEH.  No SE handler may reside in this image</span><br><span class=\"line\">#define IMAGE_DLLCHARACTERISTICS_NO_BIND      0x0800     // Do not bind this image.</span><br><span class=\"line\">#define IMAGE_DLLCHARACTERISTICS_APPCONTAINER 0x1000     // Image should execute in an AppContainer</span><br><span class=\"line\">#define IMAGE_DLLCHARACTERISTICS_WDM_DRIVER   0x2000     // Driver uses WDM model</span><br><span class=\"line\">#define IMAGE_DLLCHARACTERISTICS_GUARD_CF     0x4000     // Image supports Control Flow Guard.</span><br><span class=\"line\">#define IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE     0x8000</span><br></pre></td></tr></table></figure>\n\n\n\n<h5 id=\"NumberOfRvaAndSizes\"><a href=\"#NumberOfRvaAndSizes\" class=\"headerlink\" title=\"NumberOfRvaAndSizes\"></a>NumberOfRvaAndSizes</h5><h5 id=\"DataDirectory\"><a href=\"#DataDirectory\" class=\"headerlink\" title=\"DataDirectory\"></a>DataDirectory</h5><p>DataDirectory是由IMAGE_DATA_DIRECTORY结构体组成的数组</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">typedef struct _IMAGE_DATA_DIRECTORY &#123;</span><br><span class=\"line\">    DWORD   VirtualAddress;</span><br><span class=\"line\">    DWORD   Size;</span><br><span class=\"line\">&#125; IMAGE_DATA_DIRECTORY, *PIMAGE_DATA_DIRECTORY;</span><br></pre></td></tr></table></figure>\n\n<p>数组每项的定义</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// Directory Entries</span><br><span class=\"line\"></span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_EXPORT          0   // Export Directory</span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_IMPORT          1   // Import Directory</span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_RESOURCE        2   // Resource Directory</span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_EXCEPTION       3   // Exception Directory</span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_SECURITY        4   // Security Directory</span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_BASERELOC       5   // Base Relocation Table</span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_DEBUG           6   // Debug Directory</span><br><span class=\"line\">//      IMAGE_DIRECTORY_ENTRY_COPYRIGHT       7   // (X86 usage)</span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_ARCHITECTURE    7   // Architecture Specific Data</span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_GLOBALPTR       8   // RVA of GP</span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_TLS             9   // TLS Directory</span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_LOAD_CONFIG    10   // Load Configuration Directory</span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_BOUND_IMPORT   11   // Bound Import Directory in headers</span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_IAT            12   // Import Address Table</span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_DELAY_IMPORT   13   // Delay Load Import Descriptors</span><br><span class=\"line\">#define IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR 14   // COM Runtime descriptor</span><br><span class=\"line\">Reserved Directory</span><br></pre></td></tr></table></figure>\n\n","text":"PE文件种类 种类 主扩展名 可执行系列 EXE、SRC 库系列 DLL、OCX、CPL、DRV 驱动程序系列 SYS、VXD 对象文件系列 OBJ 严格来说，...","permalink":"/post/PE文件格式","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[],"tags":[{"name":"逆向","slug":"逆向","count":9,"path":"api/tags/逆向.json"},{"name":"PE文件","slug":"PE文件","count":3,"path":"api/tags/PE文件.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#PE%E6%96%87%E4%BB%B6%E7%A7%8D%E7%B1%BB\"><span class=\"toc-text\">PE文件种类</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84\"><span class=\"toc-text\">基本结构</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#VA-amp-RVA\"><span class=\"toc-text\">VA&amp;RVA</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#PE%E5%A4%B4\"><span class=\"toc-text\">PE头</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#DOS%E5%A4%B4%EF%BC%88IMAGE-DOS-HEADER%EF%BC%89\"><span class=\"toc-text\">DOS头（IMAGE_DOS_HEADER）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#IMAGE-DOS-HEADER%E7%BB%93%E6%9E%84%E4%BD%93\"><span class=\"toc-text\">IMAGE_DOS_HEADER结构体</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98\"><span class=\"toc-text\">重要成员</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#e-magic%EF%BC%880x00%EF%BC%89\"><span class=\"toc-text\">e_magic（0x00）</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#e-lfanew%EF%BC%880x3c%EF%BC%89\"><span class=\"toc-text\">e_lfanew（0x3c）</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#DOS%E5%AD%98%E6%A0%B9%EF%BC%88IMAGE-DOS-STUB%EF%BC%89\"><span class=\"toc-text\">DOS存根（IMAGE_DOS_STUB）</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#NT%E5%A4%B4%EF%BC%88IMAGE-NT-HEADERS%EF%BC%89%EF%BC%880x3c%EF%BC%89\"><span class=\"toc-text\">NT头（IMAGE_NT_HEADERS）（0x3c）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#32%E4%BD%8D\"><span class=\"toc-text\">32位</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#64%E4%BD%8D\"><span class=\"toc-text\">64位</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#NT%E5%A4%B4%EF%BC%9A%E6%96%87%E4%BB%B6%E5%A4%B4%EF%BC%880x04%EF%BC%89\"><span class=\"toc-text\">NT头：文件头（0x04）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#IMAGE-FILE-HEADER%E7%BB%93%E6%9E%84%E4%BD%93\"><span class=\"toc-text\">IMAGE_FILE_HEADER结构体</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98-1\"><span class=\"toc-text\">重要成员</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Machine%EF%BC%880x00%EF%BC%89\"><span class=\"toc-text\">Machine（0x00）</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#NumberOfSections\"><span class=\"toc-text\">NumberOfSections</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#SizeOfOptionalHeader\"><span class=\"toc-text\">SizeOfOptionalHeader</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Characteristics\"><span class=\"toc-text\">Characteristics</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#NT%E5%A4%B4%EF%BC%9A%E5%8F%AF%E9%80%89%E5%A4%B4%EF%BC%880x18%EF%BC%89\"><span class=\"toc-text\">NT头：可选头（0x18）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#IMAGE-OPTIONAL-HEADER32%E7%BB%93%E6%9E%84%E4%BD%93\"><span class=\"toc-text\">IMAGE_OPTIONAL_HEADER32结构体</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E9%87%8D%E8%A6%81%E6%88%90%E5%91%98-2\"><span class=\"toc-text\">重要成员</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Magic\"><span class=\"toc-text\">Magic</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#ImageBase\"><span class=\"toc-text\">ImageBase</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#SectionAlignment%E3%80%81FileAlignment\"><span class=\"toc-text\">SectionAlignment、FileAlignment</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#SizeOfImage\"><span class=\"toc-text\">SizeOfImage</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#SizeOfHeaders\"><span class=\"toc-text\">SizeOfHeaders</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Subsystem\"><span class=\"toc-text\">Subsystem</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#DllCharacteristics\"><span class=\"toc-text\">DllCharacteristics</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#NumberOfRvaAndSizes\"><span class=\"toc-text\">NumberOfRvaAndSizes</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#DataDirectory\"><span class=\"toc-text\">DataDirectory</span></a></li></ol></li></ol></li></ol></li></ol></li></ol>","author":{"name":"0netry","slug":"blog-author","avatar":"/img/tree.png","link":"/","description":"0与1只在一念之间","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"PE解析——IAT","uid":"72108d70d9a862b742fe8e97b0c6b415","slug":"PE解析——IAT","date":"2021-12-23T11:51:51.000Z","updated":"2025-06-08T15:10:02.038Z","comments":true,"path":"api/articles/PE解析——IAT.json","keywords":null,"cover":[],"text":"IAT全称Import Address Table，即导入地址表 IMAGE_IMPORT_DESCRIPTOR结构体123456789101112131415...","permalink":"/post/PE解析——IAT","photos":[],"count_time":{"symbolsCount":"5.5k","symbolsTime":"5 mins."},"categories":[],"tags":[{"name":"逆向","slug":"逆向","count":9,"path":"api/tags/逆向.json"},{"name":"PE文件","slug":"PE文件","count":3,"path":"api/tags/PE文件.json"},{"name":"IAT","slug":"IAT","count":1,"path":"api/tags/IAT.json"}],"author":{"name":"0netry","slug":"blog-author","avatar":"/img/tree.png","link":"/","description":"0与1只在一念之间","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{}}